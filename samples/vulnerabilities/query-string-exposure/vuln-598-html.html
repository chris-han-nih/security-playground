<!--
⚠️ WARNING: 이 코드는 교육 목적의 취약한 예제입니다.
절대로 프로덕션 환경에서 사용하지 마세요!

CWE-598: Use of GET Request Method With Sensitive Query Strings
이 HTML은 GET 메서드로 민감한 정보를 전송하는 취약한 패턴을 보여줍니다.
-->
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>취약한 로그인 폼 예제</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
        }
        .warning {
            background-color: #ffebee;
            border: 2px solid #f44336;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        .warning h2 {
            color: #c62828;
            margin-top: 0;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="text"],
        input[type="password"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background-color: #f44336;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .vulnerability-note {
            background-color: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 10px;
            margin: 10px 0;
        }
        code {
            background-color: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
        }
        #resultUrl {
            word-break: break-all;
            font-family: monospace;
            background: #f5f5f5;
            padding: 10px;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="warning">
        <h2>WARNING: 교육 목적의 취약한 예제</h2>
        <p>이 페이지는 보안 취약점을 설명하기 위한 예제입니다.</p>
        <p>실제 서비스에서 이런 방식을 사용하면 안 됩니다!</p>
    </div>

    <h1>취약한 로그인 폼 #1</h1>
    <p class="vulnerability-note">
        <strong>[취약점]</strong> GET 메서드 사용<br>
        폼 전송 시 URL이 다음과 같이 변경됩니다:<br>
        <code>/login?username=admin&amp;password=secret123</code>
    </p>

    <!-- [취약점] method="GET"으로 설정되어 비밀번호가 URL에 노출됨 -->
    <form action="/login" method="GET">
        <div class="form-group">
            <label for="username1">사용자명:</label>
            <input type="text" id="username1" name="username" placeholder="admin">
        </div>
        <div class="form-group">
            <label for="password1">비밀번호:</label>
            <!-- GET 요청 시 비밀번호가 URL에 평문으로 노출됨 -->
            <input type="password" id="password1" name="password" placeholder="secret123">
        </div>
        <button type="submit">로그인 (GET - 취약함)</button>
    </form>

    <hr>

    <h1>취약한 로그인 폼 #2</h1>
    <p class="vulnerability-note">
        <strong>[취약점]</strong> JavaScript로 GET 요청 전송<br>
        fetch API 또는 XMLHttpRequest로 쿼리 스트링에 민감 정보 포함
    </p>

    <form id="jsLoginForm">
        <div class="form-group">
            <label for="username2">사용자명:</label>
            <input type="text" id="username2" placeholder="admin">
        </div>
        <div class="form-group">
            <label for="password2">비밀번호:</label>
            <input type="password" id="password2" placeholder="secret123">
        </div>
        <button type="submit">로그인 (JS GET - 취약함)</button>
    </form>

    <div id="resultUrl"></div>

    <script>
        /**
         * WARNING: 이 JavaScript 코드는 취약한 패턴을 보여줍니다.
         * 실제 서비스에서 사용하지 마세요!
         */

        document.getElementById('jsLoginForm').addEventListener('submit', function(e) {
            e.preventDefault();

            var username = document.getElementById('username2').value;
            var password = document.getElementById('password2').value;

            // [취약점] 비밀번호를 쿼리 스트링에 포함하여 GET 요청
            // 이 URL은 브라우저 히스토리, 서버 로그, Referer 헤더에 기록됨
            var vulnerableUrl = '/api/login?username=' + encodeURIComponent(username) + '&password=' + encodeURIComponent(password);

            console.log('[취약점] 전송될 URL:', vulnerableUrl);

            // 결과 표시 (안전한 textContent 사용)
            var resultDiv = document.getElementById('resultUrl');
            resultDiv.style.display = 'block';
            resultDiv.textContent = '전송될 URL (취약함): ' + vulnerableUrl;

            // 실제 요청은 보내지 않음 (교육 목적)
            // fetch(vulnerableUrl).then(response => response.json());
        });

        /**
         * [취약점] 쿼리 스트링으로 토큰을 전달하는 함수
         */
        function vulnerableAPICall(token) {
            // 토큰이 URL에 노출됨
            var url = '/api/data?token=' + encodeURIComponent(token);
            console.log('[취약점] API 호출 URL:', url);
            // fetch(url);
        }

        /**
         * [취약점] URL에 개인정보를 포함하는 함수
         */
        function vulnerableRedirect(userId, ssn) {
            // 개인정보가 URL에 노출됨
            var url = '/user/profile?id=' + userId + '&ssn=' + encodeURIComponent(ssn);
            console.log('[취약점] 리다이렉트 URL:', url);
            // window.location.href = url;
        }
    </script>

    <hr>

    <h2>취약점 설명</h2>
    <p>위의 예제들은 다음과 같은 보안 문제를 가지고 있습니다:</p>
    <ol>
        <li><strong>서버 로그 노출:</strong> GET 요청의 URL은 웹 서버 액세스 로그에 그대로 기록됩니다.</li>
        <li><strong>브라우저 히스토리:</strong> URL이 브라우저 방문 기록에 저장되어 다른 사람이 볼 수 있습니다.</li>
        <li><strong>Referer 헤더:</strong> 다른 사이트로 이동할 때 이전 URL이 Referer 헤더로 전송됩니다.</li>
        <li><strong>북마크:</strong> 사용자가 실수로 민감한 정보가 포함된 URL을 북마크할 수 있습니다.</li>
    </ol>

    <p><strong>안전한 방법:</strong> 민감한 정보는 POST 메서드의 요청 본문(Request Body)이나 Authorization 헤더를 통해 전송해야 합니다.</p>
</body>
</html>
